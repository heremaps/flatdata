sudo: required
language: cpp

services:
  - docker

env:
  global:
    - DOCKER_IMAGE=boxdot/flatdata-dev:15
  matrix:
    - C_COMPILER=clang CXX_COMPILER=clang++
    - C_COMPILER=gcc CXX_COMPILER=g++

before_install:
  - docker pull $DOCKER_IMAGE

script:
  - |
    docker run -t \
      -e C_COMPILER=${C_COMPILER} \
      -e CXX_COMPILER=${CXX_COMPILER} \
      -v $(pwd):/src \
      -v $(pwd)/build:/build \
      -w /build \
      $DOCKER_IMAGE /src/ci/build-and-test.sh